<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Termo de Responsabilidade - Grupo WhatsApp</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body { font-family: Arial, sans-serif; background:#f4f4f4; margin:0; padding:10px;}
.container { max-width:600px; margin:auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.2);}
h1 { text-align:center; color:#333; font-size:20px;}
p { font-size:14px; line-height:1.5; color:#555;}
input[type="text"] { width:100%; padding:10px; font-size:16px; margin:10px 0; border-radius:6px; border:1px solid #ccc;}
button { background-color:#4CAF50; color:white; border:none; padding:12px 20px; font-size:16px; border-radius:8px; cursor:pointer; margin-top:10px; width:100%;}
button:hover { background-color:#45a049;}
.notice { margin-top:20px; color:#d9534f; font-weight:bold; text-align:center; font-size:14px;}
#infoData { margin-top:10px; font-size:14px; color:#333; text-align:center;}
canvas { border:1px solid #ccc; border-radius:8px; display:block; margin:auto; margin-top:10px; background:#fff; touch-action: none; }
</style>
</head>
<body>

<div class="container">
<img src="https://i.ibb.co/chGrPSNm/Screenshot-20250609-030533-Canva.jpg" alt="Logo do Grupo" style="display:block; margin:auto; width:100px; border-radius:8px;">
<h1>Termo de Responsabilidade</h1>

<p>Eu, <input type="text" id="nome" placeholder="Digite seu nome completo">, participante do grupo de WhatsApp <strong>C.E.U. SÃO SEBASTIÃO REI OXOSSI</strong> (Número: 85986966786), declaro que estou ciente de que todas as conversas, mensagens, áudios e documentos compartilhados neste grupo são estritamente privados e de uso exclusivo dos membros aqui presentes.</p>

<p>Fica expressamente proibida a divulgação, reprodução ou compartilhamento de qualquer conteúdo deste grupo para pessoas externas, sob pena de responsabilização judicial conforme o <strong>art. 187 do Código Civil</strong> e a <strong>Lei nº 12.965/2014 (Marco Civil da Internet)</strong>.</p>

<p>Assine abaixo com seu dedo para confirmar o termo:</p>
<canvas id="assinatura" width="500" height="150"></canvas>
<button id="limpar">Limpar Assinatura</button>
<br>
<button id="gerarPDF">Gerar PDF e Enviar ao Administrador</button>

<div id="infoData"></div>
<div class="notice">⚠️ O PDF gerado deve ser enviado ao administrador do grupo para validação.</div>
</div>

<script>
const canvas = document.getElementById('assinatura');
const ctx = canvas.getContext('2d');
let desenhando = false;

// Ajuste de densidade para celular
function getPos(e){
    const rect = canvas.getBoundingClientRect();
    let x, y;
    if(e.touches){
        x = e.touches[0].clientX - rect.left;
        y = e.touches[0].clientY - rect.top;
    } else {
        x = e.clientX - rect.left;
        y = e.clientY - rect.top;
    }
    return {x, y};
}

// Início do desenho
canvas.addEventListener('mousedown', e => { desenhando = true; const pos = getPos(e); ctx.beginPath(); ctx.moveTo(pos.x,pos.y); });
canvas.addEventListener('touchstart', e => { desenhando = true; const pos = getPos(e); ctx.beginPath(); ctx.moveTo(pos.x,pos.y); e.preventDefault(); });

// Movimento
canvas.addEventListener('mousemove', e => { if(!desenhando) return; const pos = getPos(e); ctx.lineTo(pos.x,pos.y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(pos.x,pos.y); });
canvas.addEventListener('touchmove', e => { if(!desenhando) return; const pos = getPos(e); ctx.lineTo(pos.x,pos.y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(pos.x,pos.y); e.preventDefault(); });

// Fim do desenho
canvas.addEventListener('mouseup', () => desenhando=false);
canvas.addEventListener('mouseout', () => desenhando=false);
canvas.addEventListener('touchend', () => desenhando=false);

ctx.lineWidth = 3;
ctx.lineCap = "round";
ctx.strokeStyle = "#000";

// Limpar assinatura
document.getElementById('limpar').addEventListener('click', () => { ctx.clearRect(0,0,canvas.width,canvas.height); });

// Gerar PDF
document.getElementById('gerarPDF').addEventListener('click', () => {
    const nome = document.getElementById('nome').value.trim();
    if(!nome) return alert('Digite seu nome completo.');
    const dataAssinatura = ctx.getImageData(0,0,canvas.width,canvas.height).data;
    if(dataAssinatura.every(v => v===0)) return alert('Por favor, assine o termo antes de gerar o PDF.');

    document.getElementById('nome').disabled = true;
    document.getElementById('gerarPDF').disabled = true;
    document.getElementById('gerarPDF').textContent = "Assinado ✅";

    const agora = new Date();
    const dataHora = agora.toLocaleString('pt-BR', {dateStyle:'short', timeStyle:'short'});
    document.getElementById('infoData').innerHTML = `Data e horário do acordo: ${dataHora}`;

    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const img = new Image();
    img.crossOrigin="anonymous";
    img.src="https://i.ibb.co/chGrPSNm/Screenshot-20250609-030533-Canva.jpg";
    img.onload = function(){
        const imgWidth = 50;
        const imgHeight = (img.height/img.width)*imgWidth;
        doc.addImage(img,'JPEG',80,10,imgWidth,imgHeight);

        doc.setFontSize(18);
        doc.text("Termo de Responsabilidade", 105, 70, null, null, "center");
        doc.setFontSize(12);
        let y = 90;
        doc.text(`Participante: ${nome}`, 20, y); y+=10;
        doc.text(`Grupo: C.E.U. SÃO SEBASTIÃO REI OXOSSI`, 20, y); y+=10;
        doc.text(`Número do grupo: 85986966786`, 20, y); y+=10;
        doc.text(`Data/Hora: ${dataHora}`, 20, y); y+=20;
        doc.text("Declaro que estou ciente que todas as conversas e mensagens deste grupo são privadas.", 20, y, {maxWidth:170}); y+=10;
        doc.text("Fica proibido compartilhar qualquer conteúdo externo, sob pena de responsabilização judicial.", 20, y, {maxWidth:170}); y+=10;
        doc.text("Ao assinar, assumo responsabilidade pelo cumprimento desta cláusula.", 20, y, {maxWidth:170}); y+=20;

        const assinaturaData = canvas.toDataURL('image/png');
        doc.addImage(assinaturaData,'PNG',20,y,170,60);

        doc.save(`Termo_${nome.replace(/ /g,"_")}.pdf`);
        alert("PDF gerado com sucesso! Envie-o ao administrador do grupo pelo WhatsApp ou outro meio para validação.");
    };
});
</script>

</body>
</html>
